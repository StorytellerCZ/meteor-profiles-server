<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: profiles.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: profiles.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * DB Schema for Profile
 */
Profile.appendSchema({
  "biography": {
    type: String,
    optional: true
  },
  "avatar": {
    type: String,
    optional: true
  },
  "givenName": {
    type: String,
    optional: true
  },
  "familyName": {
    type: String,
    optional: true
  }
})

Meteor.methods({
  /**
   * Updates user's avatar
   * @function call updateAvatar
   * @param {string} avatar
   * @returns {boolean}
   */
  updateAvatar:function(avatar){
    check(avatar, String)
    let profile = Meteor.profiles.findOne({userId: Meteor.userId()}).update({$set: {avatar: avatar}})
    if(profile === undefined){
      return true
    } else {
      return false
    }
  },
  /**
   * Updates user's biography
   * @function call updateBiography
   * @param {string} bio
   * @returns {boolean}
   */
  updateBiography:function(bio){
    check(bio, String)
    let profile = Meteor.profiles.findOne({userId: Meteor.userId()}).update({$set: {biography: bio}})
    //console.log(profile);
    if(profile === undefined){
      return true
    } else {
      return false
    }

    //profile.set('biography', bio)
    //let save = profile.save()
    //console.log(save);
  },
  /**
   * Updates user's name
   * @function call updateName
   * @param {object} names object containing the given and family name {given: "firstname", family: "surname"}
   * @returns {boolean}
   */
  updateName:function(names){
    //TODO: .save() returns an error and object, even though it saves
    let profile = Meteor.profiles.findOne({userId: Meteor.userId()})/*
    if(names.given){
      check(names.given, String)
      profile.set("givenName", names.given)
    }
    if(names.family){
      check(names.family, String)
      profile.set("familyName", names.family)
    }
    let result = profile.save()
    */

    let result = profile.update({$set: {givenName: names.given, familyName: names.family}})

    console.log(result);
    if(result){
      return true
    } else {
      return false
    }
  }
})
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#callupdateAvatar">call updateAvatar</a></li><li><a href="global.html#callupdateBiography">call updateBiography</a></li><li><a href="global.html#callupdateName">call updateName</a></li><li><a href="global.html#publicationfeed">publication feed</a></li><li><a href="global.html#publicationfriendRequests">publication friendRequests</a></li><li><a href="global.html#publicationfriends">publication friends</a></li><li><a href="global.html#publicationignoredFriendRequests">publication ignoredFriendRequests</a></li><li><a href="global.html#publicationoutgoingFriendRequests">publication outgoingFriendRequests</a></li><li><a href="global.html#publicationposts">publication posts</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Mon Mar 07 2016 18:02:41 GMT-0500 (EST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
